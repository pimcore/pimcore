<!DOCTYPE html>
<html>
<head>
    <title>Maintenance Mode</title>
</head>

<style type="text/css">

    body {
        padding-top:50px;
        margin:0;
    }

    #main {
        height: 290px;
        margin-top: -145px;
        position: absolute;
        top: 50%;
        width: 100%;
    }

    #info {
        width: 1000px;
        height: 365px;
        margin: 0 auto;
        position: relative;
    }

    #paper {
        position: absolute;
        left: 0;
        top: 0;
        background: url(/pimcore/static6/img/maintenance.png) no-repeat center center;
        width: 1000px;
        height: 365px;
        z-index: 2;
    }

    #code {
        position: absolute;
        left: 10px;
        top: 10px;
        height: 325px;
        width: 400px;
        z-index: 1;
        overflow: hidden;
    }

    .hl {
        position: absolute;
        top: 300;
        left: 0;
        background: #fff;
        line-height: 16px;
        display:none;
    }

    .hl .c{color:#998;font-style:italic}.hl .err{color:#a61717;background-color:#e3d2d2}.hl .k{font-weight:bold}.hl .o{font-weight:bold}.hl .cm{color:#998;font-style:italic}.hl .cp{color:#999;font-weight:bold}.hl .c1{color:#998;font-style:italic}.hl .cs{color:#999;font-weight:bold;font-style:italic}.hl .gd{color:#000;background-color:#fdd}.hl .gd .x{color:#000;background-color:#faa}.hl .ge{font-style:italic}.hl .gr{color:#a00}.hl .gh{color:#999}.hl .gi{color:#000;background-color:#dfd}.hl .gi .x{color:#000;background-color:#afa}.hl .go{color:#888}.hl .gp{color:#555}.hl .gs{font-weight:bold}.hl .gu{color:#800080;font-weight:bold}.hl .gt{color:#a00}.hl .kc{font-weight:bold}.hl .kd{font-weight:bold}.hl .kn{font-weight:bold}.hl .kp{font-weight:bold}.hl .kr{font-weight:bold}.hl .kt{color:#458;font-weight:bold}.hl .m{color:#099}.hl .s{color:#d14}.hl .n{color:#333}.hl .na{color:#008080}.hl .nb{color:#0086b3}.hl .nc{color:#458;font-weight:bold}.hl .no{color:#008080}.hl .ni{color:#800080}.hl .ne{color:#900;font-weight:bold}.hl .nf{color:#900;font-weight:bold}.hl .nn{color:#555}.hl .nt{color:#000080}.hl .nv{color:#008080}.hl .ow{font-weight:bold}.hl .w{color:#bbb}.hl .mf{color:#099}.hl .mh{color:#099}.hl .mi{color:#099}.hl .mo{color:#099}.hl .sb{color:#d14}.hl .sc{color:#d14}.hl .sd{color:#d14}.hl .s2{color:#d14}.hl .se{color:#d14}.hl .sh{color:#d14}.hl .si{color:#d14}.hl .sx{color:#d14}.hl .sr{color:#009926}.hl .s1{color:#d14}.hl .ss{color:#990073}.hl .bp{color:#999}.hl .vc{color:#008080}.hl .vg{color:#008080}.hl .vi{color:#008080}.hl .il{color:#099}.hl .gc{color:#999;background-color:#eaf2f5}

</style>

<body>


<div id="main">
    <div id="info">
        <div id="paper"></div>
        <div id="code">
            <div id="scroll" class="hl"><pre><div class="line"><span class="o">&lt;?</span><span class="nx">php</span></div><div class="line"><span class="sd">/**</span></div><div class="line"><span class="sd"> * Zend Framework</span></div><div class="line"><span class="sd"> *</span></div><div class="line"><span class="sd"> * LICENSE</span></div><div class="line"><span class="sd"> *</span></div><div class="line"><span class="sd"> * This source file is subject to the new BSD license that is bundled</span></div><div class="line"><span class="sd"> * with this package in the file LICENSE.txt.</span></div><div class="line"><span class="sd"> * It is also available through the world-wide-web at this URL:</span></div><div class="line"><span class="sd"> * http://framework.zend.com/license/new-bsd</span></div><div class="line"><span class="sd"> * If you did not receive a copy of the license and are unable to</span></div><div class="line"><span class="sd"> * obtain it through the world-wide-web, please send an email</span></div><div class="line"><span class="sd"> * to license@zend.com so we can send you a copy immediately.</span></div><div class="line"><span class="sd"> *</span></div><div class="line"><span class="sd"> * @category   Zend</span></div><div class="line"><span class="sd"> * @package    Zend_Controller</span></div><div class="line"><span class="sd"> * @copyright  Copyright (c) 2005-2012 Zend Technologies USA Inc. (http://www.zend.com)</span></div><div class="line"><span class="sd"> * @license    http://framework.zend.com/license/new-bsd     New BSD License</span></div><div class="line"><span class="sd"> * @version    $Id: Front.php 24593 2012-01-05 20:35:02Z matthew $</span></div><div class="line"><span class="sd"> */</span></div><div class="line"><br></div><div class="line"><br></div><div class="line"><span class="sd">/** Zend_Loader */</span></div><div class="line"><span class="c1">// require_once 'Zend/Loader.php';</span></div><div class="line"><br></div><div class="line"><span class="sd">/** Zend_Controller_Action_HelperBroker */</span></div><div class="line"><span class="c1">// require_once 'Zend/Controller/Action/HelperBroker.php';</span></div><div class="line"><br></div><div class="line"><span class="sd">/** Zend_Controller_Plugin_Broker */</span></div><div class="line"><span class="c1">// require_once 'Zend/Controller/Plugin/Broker.php';</span></div><div class="line"><br></div><div class="line"><span class="sd">/**</span></div><div class="line"><span class="sd"> * @category   Zend</span></div><div class="line"><span class="sd"> * @package    Zend_Controller</span></div><div class="line"><span class="sd"> * @copyright  Copyright (c) 2005-2012 Zend Technologies USA Inc. (http://www.zend.com)</span></div><div class="line"><span class="sd"> * @license    http://framework.zend.com/license/new-bsd     New BSD License</span></div><div class="line"><span class="sd"> */</span></div><div class="line"><span class="k">class</span> <span class="nc">Zend_Controller_Front</span></div><div class="line"><span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Base URL</span></div><div class="line"><span class="sd">     * @var string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_baseUrl</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Directory|ies where controllers are stored</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @var string|array</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_controllerDir</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Instance of Zend_Controller_Dispatcher_Interface</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Dispatcher_Interface</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_dispatcher</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Singleton instance</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Marked only as protected to allow extension of the class. To extend,</span></div><div class="line"><span class="sd">     * simply override {@link getInstance()}.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="k">static</span> <span class="nv">$_instance</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Array of invocation parameters to use when instantiating action</span></div><div class="line"><span class="sd">     * controllers</span></div><div class="line"><span class="sd">     * @var array</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_invokeParams</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Subdirectory within a module containing controllers; defaults to 'controllers'</span></div><div class="line"><span class="sd">     * @var string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_moduleControllerDirectoryName</span> <span class="o">=</span> <span class="s1">'controllers'</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Instance of Zend_Controller_Plugin_Broker</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Plugin_Broker</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_plugins</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Instance of Zend_Controller_Request_Abstract</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Request_Abstract</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_request</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Instance of Zend_Controller_Response_Abstract</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Response_Abstract</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_response</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Whether or not to return the response prior to rendering output while in</span></div><div class="line"><span class="sd">     * {@link dispatch()}; default is to send headers and render output.</span></div><div class="line"><span class="sd">     * @var boolean</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_returnResponse</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Instance of Zend_Controller_Router_Interface</span></div><div class="line"><span class="sd">     * @var Zend_Controller_Router_Interface</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_router</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Whether or not exceptions encountered in {@link dispatch()} should be</span></div><div class="line"><span class="sd">     * thrown or trapped in the response object</span></div><div class="line"><span class="sd">     * @var boolean</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="nv">$_throwExceptions</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Constructor</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Instantiate using {@link getInstance()}; front controller is a singleton</span></div><div class="line"><span class="sd">     * object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Instantiates the plugin broker.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return void</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">protected</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Controller_Plugin_Broker</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Enforce singleton; disallow cloning</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return void</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">private</span> <span class="k">function</span> <span class="nf">__clone</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Singleton instance</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getInstance</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">self</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$_instance</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Resets all object properties of the singleton instance</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Primarily used for testing; could be used to chain front controllers.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Also resets action helper broker, clearing all registered helpers.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return void</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">resetInstance</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$reflection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ReflectionObject</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">foreach</span> <span class="p">(</span><span class="nv">$reflection</span><span class="o">-&gt;</span><span class="na">getProperties</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$property</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$name</span> <span class="o">=</span> <span class="nv">$property</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">switch</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_instance'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_controllerDir'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_invokeParams'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_plugins'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Controller_Plugin_Broker</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_throwExceptions'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_returnResponse'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">case</span> <span class="s1">'_moduleControllerDirectoryName'</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">=</span> <span class="s1">'controllers'</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">default</span><span class="o">:</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$name</span><span class="p">}</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Zend_Controller_Action_HelperBroker</span><span class="o">::</span><span class="na">resetHelpers</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Convenience feature, calls setControllerDirectory()-&gt;setRouter()-&gt;dispatch()</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * In PHP 5.1.x, a call to a static method never populates $this -- so run()</span></div><div class="line"><span class="sd">     * may actually be called after setting up your front controller.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string|array $controllerDirectory Path to Zend_Controller_Action</span></div><div class="line"><span class="sd">     * controller classes or array of such paths</span></div><div class="line"><span class="sd">     * @return void</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception if called from an object instance</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(</span><span class="nv">$controllerDirectory</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">self</span><span class="o">::</span><span class="na">getInstance</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">-&gt;</span><span class="na">setControllerDirectory</span><span class="p">(</span><span class="nv">$controllerDirectory</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">-&gt;</span><span class="na">dispatch</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Add a controller directory to the controller directory stack</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * If $args is presented and is a string, uses it for the array key mapping</span></div><div class="line"><span class="sd">     * to the directory specified.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $directory</span></div><div class="line"><span class="sd">     * @param string $module Optional argument; module with which to associate directory. If none provided, assumes 'default'</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception if directory not found or readable</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">addControllerDirectory</span><span class="p">(</span><span class="nv">$directory</span><span class="p">,</span> <span class="nv">$module</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addControllerDirectory</span><span class="p">(</span><span class="nv">$directory</span><span class="p">,</span> <span class="nv">$module</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set controller directory</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Stores controller directory(ies) in dispatcher. May be an array of</span></div><div class="line"><span class="sd">     * directories or a string containing a single directory.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string|array $directory Path to Zend_Controller_Action controller</span></div><div class="line"><span class="sd">     * classes or array of such paths</span></div><div class="line"><span class="sd">     * @param  string $module Optional module name to use with string $directory</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setControllerDirectory</span><span class="p">(</span><span class="nv">$directory</span><span class="p">,</span> <span class="nv">$module</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setControllerDirectory</span><span class="p">(</span><span class="nv">$directory</span><span class="p">,</span> <span class="nv">$module</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve controller directory</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Retrieves:</span></div><div class="line"><span class="sd">     * - Array of all controller directories if no $name passed</span></div><div class="line"><span class="sd">     * - String path if $name passed and exists as a key in controller directory array</span></div><div class="line"><span class="sd">     * - null if $name passed but does not exist in controller directory keys</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $name Default null</span></div><div class="line"><span class="sd">     * @return array|string|null</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getControllerDirectory</span><span class="p">(</span><span class="nv">$name</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getControllerDirectory</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Remove a controller directory by module name</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $module</span></div><div class="line"><span class="sd">     * @return bool</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">removeControllerDirectory</span><span class="p">(</span><span class="nv">$module</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">removeControllerDirectory</span><span class="p">(</span><span class="nv">$module</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Specify a directory as containing modules</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Iterates through the directory, adding any subdirectories as modules;</span></div><div class="line"><span class="sd">     * the subdirectory within each module named after {@link $_moduleControllerDirectoryName}</span></div><div class="line"><span class="sd">     * will be used as the controller directory path.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $path</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">addModuleDirectory</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span><span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dir</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DirectoryIterator</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Exception.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="nx">Zend_Controller_Exception</span><span class="p">(</span><span class="s2">"Directory </span><span class="si">$path</span><span class="s2"> not readable"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$e</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">foreach</span> <span class="p">(</span><span class="nv">$dir</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="o">-&gt;</span><span class="na">isDot</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="nv">$file</span><span class="o">-&gt;</span><span class="na">isDir</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">continue</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$module</span>    <span class="o">=</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">getFilename</span><span class="p">();</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Don't use SCCS directories as modules</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^[^a-z]/i'</span><span class="p">,</span> <span class="nv">$module</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="s1">'CVS'</span> <span class="o">==</span> <span class="nv">$module</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">continue</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$moduleDir</span> <span class="o">=</span> <span class="nv">$file</span><span class="o">-&gt;</span><span class="na">getPathname</span><span class="p">()</span> <span class="o">.</span> <span class="nx">DIRECTORY_SEPARATOR</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getModuleControllerDirectoryName</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addControllerDirectory</span><span class="p">(</span><span class="nv">$moduleDir</span><span class="p">,</span> <span class="nv">$module</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the path to a module directory (but not the controllers directory within)</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $module</span></div><div class="line"><span class="sd">     * @return string|null</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getModuleDirectory</span><span class="p">(</span><span class="nv">$module</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$module</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$request</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$module</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getModuleName</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$module</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$module</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getDefaultModule</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$controllerDir</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getControllerDirectory</span><span class="p">(</span><span class="nv">$module</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">((</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$controllerDir</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$controllerDir</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">null</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$controllerDir</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the directory name within a module containing controllers</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $name</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setModuleControllerDirectoryName</span><span class="p">(</span><span class="nv">$name</span> <span class="o">=</span> <span class="s1">'controllers'</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_moduleControllerDirectoryName</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$name</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the directory name within a module containing controllers</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getModuleControllerDirectoryName</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_moduleControllerDirectoryName</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the default controller (unformatted string)</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $controller</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setDefaultControllerName</span><span class="p">(</span><span class="nv">$controller</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span><span class="o">-&gt;</span><span class="na">setDefaultControllerName</span><span class="p">(</span><span class="nv">$controller</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve the default controller (unformatted string)</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getDefaultControllerName</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getDefaultControllerName</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the default action (unformatted string)</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $action</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setDefaultAction</span><span class="p">(</span><span class="nv">$action</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span><span class="o">-&gt;</span><span class="na">setDefaultAction</span><span class="p">(</span><span class="nv">$action</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve the default action (unformatted string)</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getDefaultAction</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getDefaultAction</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the default module name</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $module</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setDefaultModule</span><span class="p">(</span><span class="nv">$module</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span><span class="o">-&gt;</span><span class="na">setDefaultModule</span><span class="p">(</span><span class="nv">$module</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve the default module</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getDefaultModule</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getDefaultModule</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set request class/object</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Set the request object.  The request holds the request environment.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * If a class name is provided, it will instantiate it</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string|Zend_Controller_Request_Abstract $request</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception if invalid request class</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$request</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">class_exists</span><span class="p">(</span><span class="nv">$request</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Loader.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Zend_Loader</span><span class="o">::</span><span class="na">loadClass</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$request</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$request</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$request</span> <span class="nx">instanceof</span> <span class="nx">Zend_Controller_Request_Abstract</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Exception.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="nx">Zend_Controller_Exception</span><span class="p">(</span><span class="s1">'Invalid request class'</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span> <span class="o">=</span> <span class="nv">$request</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the request object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return null|Zend_Controller_Request_Abstract</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getRequest</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set router class/object</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Set the router object.  The router is responsible for mapping</span></div><div class="line"><span class="sd">     * the request to a controller and action.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * If a class name is provided, instantiates router with any parameters</span></div><div class="line"><span class="sd">     * registered via {@link setParam()} or {@link setParams()}.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string|Zend_Controller_Router_Interface $router</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception if invalid router class</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setRouter</span><span class="p">(</span><span class="nv">$router</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$router</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">class_exists</span><span class="p">(</span><span class="nv">$router</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Loader.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Zend_Loader</span><span class="o">::</span><span class="na">loadClass</span><span class="p">(</span><span class="nv">$router</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$router</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$router</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$router</span> <span class="nx">instanceof</span> <span class="nx">Zend_Controller_Router_Interface</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Exception.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="nx">Zend_Controller_Exception</span><span class="p">(</span><span class="s1">'Invalid router class'</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">setFrontController</span><span class="p">(</span><span class="nv">$this</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_router</span> <span class="o">=</span> <span class="nv">$router</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the router object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Instantiates a Zend_Controller_Router_Rewrite object if no router currently set.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Router_Interface</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getRouter</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">==</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_router</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Router/Rewrite.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setRouter</span><span class="p">(</span><span class="k">new</span> <span class="nx">Zend_Controller_Router_Rewrite</span><span class="p">());</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_router</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the base URL used for requests</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Use to set the base URL segment of the REQUEST_URI to use when</span></div><div class="line"><span class="sd">     * determining PATH_INFO, etc. Examples:</span></div><div class="line"><span class="sd">     * - /admin</span></div><div class="line"><span class="sd">     * - /myapp</span></div><div class="line"><span class="sd">     * - /subdir/index.php</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Note that the URL should not include the full URI. Do not use:</span></div><div class="line"><span class="sd">     * - http://example.com/admin</span></div><div class="line"><span class="sd">     * - http://example.com/myapp</span></div><div class="line"><span class="sd">     * - http://example.com/subdir/index.php</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * If a null value is passed, this can be used as well for autodiscovery (default).</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $base</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception for non-string $base</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setBaseUrl</span><span class="p">(</span><span class="nv">$base</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$base</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$base</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Exception.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="nx">Zend_Controller_Exception</span><span class="p">(</span><span class="s1">'Rewrite base must be a string'</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_baseUrl</span> <span class="o">=</span> <span class="nv">$base</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">((</span><span class="k">null</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$request</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">()))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="s1">'setBaseUrl'</span><span class="p">)))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">setBaseUrl</span><span class="p">(</span><span class="nv">$base</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve the currently set base URL</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return string</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getBaseUrl</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$request</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">((</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$request</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">method_exists</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="s1">'getBaseUrl'</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getBaseUrl</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_baseUrl</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the dispatcher object.  The dispatcher is responsible for</span></div><div class="line"><span class="sd">     * taking a Zend_Controller_Dispatcher_Token object, instantiating the controller, and</span></div><div class="line"><span class="sd">     * call the action method of the controller.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param Zend_Controller_Dispatcher_Interface $dispatcher</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setDispatcher</span><span class="p">(</span><span class="nx">Zend_Controller_Dispatcher_Interface</span> <span class="nv">$dispatcher</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_dispatcher</span> <span class="o">=</span> <span class="nv">$dispatcher</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the dispatcher object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Dispatcher_Interface</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getDispatcher</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Instantiate the default dispatcher if one was not set.</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_dispatcher</span> <span class="nx">instanceof</span> <span class="nx">Zend_Controller_Dispatcher_Interface</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Dispatcher/Standard.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_dispatcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Controller_Dispatcher_Standard</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_dispatcher</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set response class/object</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Set the response object.  The response is a container for action</span></div><div class="line"><span class="sd">     * responses and headers. Usage is optional.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * If a class name is provided, instantiates a response object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string|Zend_Controller_Response_Abstract $response</span></div><div class="line"><span class="sd">     * @throws Zend_Controller_Exception if invalid response class</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setResponse</span><span class="p">(</span><span class="nv">$response</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$response</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">class_exists</span><span class="p">(</span><span class="nv">$response</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Loader.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Zend_Loader</span><span class="o">::</span><span class="na">loadClass</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$response</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$response</span> <span class="nx">instanceof</span> <span class="nx">Zend_Controller_Response_Abstract</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Exception.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="k">new</span> <span class="nx">Zend_Controller_Exception</span><span class="p">(</span><span class="s1">'Invalid response class'</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span> <span class="o">=</span> <span class="nv">$response</span><span class="p">;</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Return the response object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return null|Zend_Controller_Response_Abstract</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getResponse</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Add or modify a parameter to use when instantiating an action controller</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $name</span></div><div class="line"><span class="sd">     * @param mixed $value</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setParam</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$name</span> <span class="o">=</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$name</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$name</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set parameters to pass to action controller constructors</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param array $params</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">setParams</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">,</span> <span class="nv">$params</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve a single parameter from the controller parameter stack</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param string $name</span></div><div class="line"><span class="sd">     * @return mixed</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getParam</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$name</span><span class="p">]))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$name</span><span class="p">];</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="k">null</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve action controller instantiation parameters</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return array</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getParams</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Clear the controller parameter stack</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * By default, clears all parameters. If a parameter name is given, clears</span></div><div class="line"><span class="sd">     * only that parameter; if an array of parameter names is provided, clears</span></div><div class="line"><span class="sd">     * each.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param null|string|array single key or array of keys for params to clear</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">clearParams</span><span class="p">(</span><span class="nv">$name</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$name</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$name</span><span class="p">]))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$name</span><span class="p">]);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$name</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">foreach</span> <span class="p">(</span><span class="nv">$name</span> <span class="k">as</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$key</span><span class="p">]))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_invokeParams</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Register a plugin.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  Zend_Controller_Plugin_Abstract $plugin</span></div><div class="line"><span class="sd">     * @param  int $stackIndex Optional; stack index for plugin</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">registerPlugin</span><span class="p">(</span><span class="nx">Zend_Controller_Plugin_Abstract</span> <span class="nv">$plugin</span><span class="p">,</span> <span class="nv">$stackIndex</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">registerPlugin</span><span class="p">(</span><span class="nv">$plugin</span><span class="p">,</span> <span class="nv">$stackIndex</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Unregister a plugin.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string|Zend_Controller_Plugin_Abstract $plugin Plugin class or object to unregister</span></div><div class="line"><span class="sd">     * @return Zend_Controller_Front</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">unregisterPlugin</span><span class="p">(</span><span class="nv">$plugin</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">unregisterPlugin</span><span class="p">(</span><span class="nv">$plugin</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Is a particular plugin registered?</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $class</span></div><div class="line"><span class="sd">     * @return bool</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">hasPlugin</span><span class="p">(</span><span class="nv">$class</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">hasPlugin</span><span class="p">(</span><span class="nv">$class</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve a plugin or plugins by class</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param  string $class</span></div><div class="line"><span class="sd">     * @return false|Zend_Controller_Plugin_Abstract|array</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getPlugin</span><span class="p">(</span><span class="nv">$class</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">getPlugin</span><span class="p">(</span><span class="nv">$class</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Retrieve all plugins</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @return array</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">getPlugins</span><span class="p">()</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">getPlugins</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set the throwExceptions flag and retrieve current status</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Set whether exceptions encounted in the dispatch loop should be thrown</span></div><div class="line"><span class="sd">     * or caught and trapped in the response object.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Default behaviour is to trap them in the response object; call this</span></div><div class="line"><span class="sd">     * method to have them thrown.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * Passing no value will return the current value of the flag; passing a</span></div><div class="line"><span class="sd">     * boolean true or false value will set the flag and return the current</span></div><div class="line"><span class="sd">     * object instance.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param boolean $flag Defaults to null (return flag state)</span></div><div class="line"><span class="sd">     * @return boolean|Zend_Controller_Front Used as a setter, returns object; as a getter, returns boolean</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">throwExceptions</span><span class="p">(</span><span class="nv">$flag</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$flag</span> <span class="o">!==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_throwExceptions</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)</span> <span class="nv">$flag</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_throwExceptions</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Set whether {@link dispatch()} should return the response without first</span></div><div class="line"><span class="sd">     * rendering output. By default, output is rendered and dispatch() returns</span></div><div class="line"><span class="sd">     * nothing.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param boolean $flag</span></div><div class="line"><span class="sd">     * @return boolean|Zend_Controller_Front Used as a setter, returns object; as a getter, returns boolean</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">returnResponse</span><span class="p">(</span><span class="nv">$flag</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">true</span> <span class="o">===</span> <span class="nv">$flag</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_returnResponse</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="k">false</span> <span class="o">===</span> <span class="nv">$flag</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_returnResponse</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_returnResponse</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">     * Dispatch an HTTP request to a controller/action.</span></div><div class="line"><span class="sd">     *</span></div><div class="line"><span class="sd">     * @param Zend_Controller_Request_Abstract|null $request</span></div><div class="line"><span class="sd">     * @param Zend_Controller_Response_Abstract|null $response</span></div><div class="line"><span class="sd">     * @return void|Zend_Controller_Response_Abstract Returns response object if returnResponse() is true</span></div><div class="line"><span class="sd">     */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">public</span> <span class="k">function</span> <span class="nf">dispatch</span><span class="p">(</span><span class="nx">Zend_Controller_Request_Abstract</span> <span class="nv">$request</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nx">Zend_Controller_Response_Abstract</span> <span class="nv">$response</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">'noErrorHandler'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">hasPlugin</span><span class="p">(</span><span class="s1">'Zend_Controller_Plugin_ErrorHandler'</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Register with stack index of 100</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Plugin/ErrorHandler.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">registerPlugin</span><span class="p">(</span><span class="k">new</span> <span class="nx">Zend_Controller_Plugin_ErrorHandler</span><span class="p">(),</span> <span class="mi">100</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">'noViewRenderer'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">Zend_Controller_Action_HelperBroker</span><span class="o">::</span><span class="na">hasHelper</span><span class="p">(</span><span class="s1">'viewRenderer'</span><span class="p">))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Action/Helper/ViewRenderer.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">Zend_Controller_Action_HelperBroker</span><span class="o">::</span><span class="na">getStack</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">offsetSet</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Zend_Controller_Action_Helper_ViewRenderer</span><span class="p">());</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Instantiate default request object (HTTP version) if none provided</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">elseif</span> <span class="p">((</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$request</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="p">(</span><span class="nv">$request</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">())))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Request/Http.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Controller_Request_Http</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Set base URL of request object, if available</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">,</span> <span class="s1">'setBaseUrl'</span><span class="p">)))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_baseUrl</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="o">-&gt;</span><span class="na">setBaseUrl</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_baseUrl</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Instantiate default response object (HTTP version) if none provided</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">!==</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setResponse</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">elseif</span> <span class="p">((</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">())))</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// require_once 'Zend/Controller/Response/Http.php';</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Controller_Response_Http</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setResponse</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Register request and response objects with plugin broker</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">-&gt;</span><span class="na">setRequest</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">)</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">-&gt;</span><span class="na">setResponse</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Initialize router</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$router</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRouter</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">setParams</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getParams</span><span class="p">());</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Initialize dispatcher</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getDispatcher</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span><span class="o">-&gt;</span><span class="na">setParams</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getParams</span><span class="p">())</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">-&gt;</span><span class="na">setResponse</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Begin dispatch</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">             * Route request to controller/action, if a router is provided</span></div><div class="line"><span class="sd">             */</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">            * Notify plugins of router startup</span></div><div class="line"><span class="sd">            */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">routeStartup</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>  <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">throwExceptions</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="nv">$e</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="o">-&gt;</span><span class="na">setException</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">            * Notify plugins of router completion</span></div><div class="line"><span class="sd">            */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">routeShutdown</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">             * Notify plugins of dispatch loop startup</span></div><div class="line"><span class="sd">             */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">dispatchLoopStartup</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">             *  Attempt to dispatch the controller/action. If the $this-&gt;_request</span></div><div class="line"><span class="sd">             *  indicates that it needs to be dispatched, move to the next</span></div><div class="line"><span class="sd">             *  action in the request.</span></div><div class="line"><span class="sd">             */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">do</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="o">-&gt;</span><span class="na">setDispatched</span><span class="p">(</span><span class="k">true</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">                 * Notify plugins of dispatch startup</span></div><div class="line"><span class="sd">                 */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">preDispatch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">                 * Skip requested action if preDispatch() has reset it</span></div><div class="line"><span class="sd">                 */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="o">-&gt;</span><span class="na">isDispatched</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">continue</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">                 * Dispatch request</span></div><div class="line"><span class="sd">                 */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$dispatcher</span><span class="o">-&gt;</span><span class="na">dispatch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">throwExceptions</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="nv">$e</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="o">-&gt;</span><span class="na">setException</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">                 * Notify plugins of dispatch completion</span></div><div class="line"><span class="sd">                 */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">postDispatch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_request</span><span class="o">-&gt;</span><span class="na">isDispatched</span><span class="p">());</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">throwExceptions</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="nv">$e</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="o">-&gt;</span><span class="na">setException</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sd">/**</span></div><div class="line"><span class="sd">         * Notify plugins of dispatch loop completion</span></div><div class="line"><span class="sd">         */</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">try</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_plugins</span><span class="o">-&gt;</span><span class="na">dispatchLoopShutdown</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">throwExceptions</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="nv">$e</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="o">-&gt;</span><span class="na">setException</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">returnResponse</span><span class="p">())</span> <span class="p">{</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="p">;</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><br></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_response</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">();</span></div><div class="line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line"><span class="p">}</span></div></pre></div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var position = -2618;
    var scrollEl = document.getElementById("scroll");
    window.setInterval(function() {
        position-=10;
        if(position < -15500) {
            position = -200;
        }
        scrollEl.style.top = position + "px";
    }, 5);
    scrollEl.style.display = "block";
</script>

</body>
</html>