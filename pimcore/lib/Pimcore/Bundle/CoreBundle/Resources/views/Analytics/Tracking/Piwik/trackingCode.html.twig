{% block beforeScriptTag %}
    {{ blocks.beforeScriptTag|raw }}
{% endblock %}

<script type="text/javascript">
    {% autoescape 'js' %}
    {% spaceless %}
    {% block beforeScript %}
        {{ blocks.beforeScript|raw -}}
    {% endblock %}

    var _paq = _paq || [];

    {% block actions %}
        {{- blocks.actions|raw -}}
    {% endblock %}

    (function() {
        {% block asyncInit %}
        var u='//{{ piwikUrl }}/';
        {% endblock %}

        {% block beforeAsync %}
            {{- blocks.beforeAsync|raw -}}
        {% endblock %}

        {% block async %}
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        {% endblock %}

        {% block afterAsync %}
            {{- blocks.afterAsync|raw -}}
        {% endblock %}
    })();

    {% block afterScript %}
        {{- blocks.afterScript|raw }}
    {% endblock %}
    {% endspaceless %}
    {% endautoescape %}

</script>

{% block afterScriptTag %}
    {{- blocks.afterScriptTag|raw -}}
{% endblock %}
